#+TAGS: mail mta


* postfix							   :mail:mta:
* Description
* Usage
** Basic Admin
- View Mail Queue
#+BEGIN_SRC sh
postqueue -p
#+END_SRC
or
#+BEGIN_SRC sh
mailq
#+END_SRC

- Reload Configuration
#+BEGIN_SRC sh
service postfix reload
#+END_SRC

- Restart Postfix Server
#+BEGIN_SRC sh
service postfix restart
#+END_SRC

- View the postfix version
#+BEGIN_SRC sh
postconf mail version
#+END_SRC

- Show default postfix values
#+BEGIN_SRC sh
postconf -d
#+END_SRC

- Show non default
#+BEGIN_SRC sh
postconf -n
#+END_SRC
postfix values

- list mail queue and MAIL ID's
#+BEGIN_SRC sh
mailq
#+END_SRC

- list mail queue
#+BEGIN_SRC sh
postqueue -p
#+END_SRC

- Flush mail queue
#+BEGIN_SRC sh
postqueue -f
#+END_SRC

- Read email from mail queue
#+BEGIN_SRC sh
postcat -q $MAIL_ID
#+END_SRC

- To remove MAIL\_ID mail from the queue
#+BEGIN_SRC sh
postsuper -d $MAIL_ID
#+END_SRC

- To remove all mail from the queue
#+BEGIN_SRC sh
postsuper -d ALL
#+END_SRC

- To remove all mails in the deferred queue
#+BEGIN_SRC sh
postsuper -d ALL deferred
#+END_SRC

- Sort and count emails by "from address"
postqueue -p | awk '{print $7}' | sort | uniq -c | sort -n

- removing all emails sent by: [[mailto:user@adminlogs.info][user@adminlogs.info]]
#+BEGIN_SRC sh
postqueue -p | grep ' [2]'|grep user@adminlogs.info|cut -f1 -d' ' |tr -d |postsuper -d -
#+END_SRC

- Remove all email sent from [[mailto:user@adminlogs.info][user@adminlogs.info]]
#+BEGIN_SRC sh
postqueue -p | awk {print $1}' | cut -d '!' -f 1 | postsuper -d -
#+END_SRC

- To delete all messages from the queue by a certain user: for i in
#+BEGIN_SRC sh
postqueue -p | grep[user@domain.com](mailto:user@domain.com) | awk '{print $1}' | grep -v host | grep -v do postsuper -d $i; done
#+END_SRC

- Remove all email sent by domain adminlogs.info
#+BEGIN_SRC sh
postqueue -p | grep ' [4]'|grep @adminlogs.info|cut -f1 -d' ' |tr -d | postsuper -d -      //
#+END_SRC

- Mail queue stats short
#+BEGIN_SRC sh
postqueue -p | tail -n 1
#+END_SRC

- Number of emails in Mail queue
#+BEGIN_SRC sh
postqueue -p | grep -c
#+END_SRC

- Watch logs live
#+BEGIN_SRC sh
tail -f /var/log/maillog
#+END_SRC

* Lecture
* Tutorial
* Books
[[file://home/crito/Documents/SysAdmin/Mail/Postfix-The_Definitive_Guide.pdf][Postfix - The Definitive Guide - O'Reilly]]
* Links


