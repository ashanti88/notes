#+TAGS: mail smtp postfix


* rhel7 setting up an SMTP server
* Cmds
[[file://home/crito/org/tech/cmds/postconf.org][postconf]]
* Overview
[[file://home/crito/Pictures/org/mail_transfer_process.png][Image - Mail Transfer Process]]
* Configuration Files
** /etc/nsswitch.conf
Name Service Switch 
This file is used to indicate where to look for cetain information and what to do if this fails.
Each line specifies how to search for piece of information, and uses the following format.
#+BEGIN_SRC sh
info:method[action][method[action]...]
#+END_SRC
info - the type of information that the line describes
method - the method used to find the information
action - the response to be taken to the reply from the method

*** Information that nsswitch.conf Controls Searches For
- automount Automount (/etc/auto.master and /etc/auto.misc;)
- bootparams Diskless and other booting options (See the bootparam man page.)
- ethers MAC address
- group Groups of users (/etc/group;)
- hosts System information (/etc/hosts;)
- netgroup Netgroup information (/etc/netgroup;)
- networks Network information (/etc/networks)
- passwd User information (/etc/passwd;)
- protocols Protocol information (/etc/protocols;)
- publickey Used for NFS running in secure mode
- rpc RPC names and numbers (/etc/rpc;)
- services Services information (/etc/services;)
- shadow Shadow password information (/etc/shadow;) 

*** Methods
- files Searches local files such as /etc/passwd and /etc/hosts
- nis Searches the NIS database; yp is an alias for nis
- dns Queries the DNS (hosts queries only)
- compat ± syntax in passwd, group, and shadow files

*** Actions [[!]STATUS=action]
- STATUS
  - NOTFOUND—The method worked but the value being searched for was not found. Default action is continue.
  - SUCCESS—The method worked and the value being searched for was found; no error was returned. Default action is return.
  - UNAVAIL—The method failed because it is permanently unavailable. For example, the required file may not be accessible or the required server may be down. Default action is continue.
  - TRYAGAIN—The method failed because it was temporarily unavailable. For example, a file may be locked or a server overloaded. Default action is continue.
- values
  - return—Returns to the calling routine with or without a value.
  - continue—Continues with the next method. Any returned value is overwritten by a value found by the next method.

** /etc/postfix/master.cf
* Set up
** Essential Parameters
inet_interfaces - what interfaces postfix with provide services on
myorigin - allows you to rewrite posted email to come from a specific domain instead of $myhostname
relayhost - specifies which central mail server to forward messages to
mydestination - domains handled by this server. Mail addressed to a domain not listed in mydestination is rejected
local_transport - specifies what to use for local mail delivery
inet_protocols - specifies which protocol to use to offer services
mynetworks - space-seperated list of networks that are allowed to relay

* Lecture
* Tutorial
* Books
* Links
