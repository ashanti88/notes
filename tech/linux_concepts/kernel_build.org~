#+TAGS: kernel


* Kernel Build                                                       :kernel:
* Description
* Usage
** Building the Kernel
1. git or wget source code
#+BEGIN_SRC sh
git clone https://github.com/torvalds/linux.git
#+END_SRC

2. Make the .config file for the kerrnel build
We have 3 options
i) copy current distro .config form /proc/config.gz
#+BEGIN_SRC sh
zcat /proc/config.gz > .config
#+END_SRC
or
#+BEGIN_SRC sh
cp /usr/lib/modules/$(uname -r)/build/.config ./
cp /usr/lib/modules/$(uname -r)/build/Module.symvers ./
#+END_SRC

This should create a kernel that runs on your current distro

ii) each build normally comes with a generic .config 
#+BEGIN_SRC sh
make defconfig
#+END_SRC

iii) a custom .config can be created using
#+BEGIN_SRC sh
make config
#+END_SRC
This will setp through every configuration option

This can also be done with one of the three graphical Uis
  - menuconfig - ncurses based graphical ui
  - gconfig - GTK+ based graphical ui
  - xconfig - QT-based graphical ui
This option is time consuming and will ask you which of the thousands of parameters to set.

3. Now we have the .config we can build the kernel
#+BEGIN_SRC sh
make
#+END_SRC
This will create a kernel to the .config specification

The build process can be speeded up on a multi-core machine with the -j flag
#+BEGIN_SRC sh
make -j4
#+END_SRC
This will tell the build that we have four processors/cores

4. 
** 
* Lecture
* Tutorial
* Books
* Links
[[https://wiki.archlinux.org/index.php/Kernels/Arch_Build_System][Arch Build System]]
